#!/usr/bin/env ruby
# frozen_string_literal: true

require 'optparse'
require_relative '../toy_robot_simulator'

HELP = <<~TEXT
  ðŸ¤– TOY ROBOT SIMULATOR

  Commands: PLACE X,Y,NORTH|SOUTH|EAST|WEST, MOVE, LEFT, RIGHT, REPORT
  Example: PLACE 0,0,NORTH

  Press Ctrl+C to quit
TEXT

options = { log_level: :warn }
OptionParser.new do |opts|
  opts.banner = "Usage: toy_robot [options] [file]\n\n#{HELP}"
  opts.on('-v', '--verbose', 'Debug logging') { options[:log_level] = :debug }
  opts.on('-q', '--quiet', 'Error only') { options[:log_level] = :error }
  opts.on('-h', '--help', 'Show help') do
    puts opts
    exit
  end
end.parse!

input = ARGV.first ? File.open(ARGV.first) : $stdin
if input == $stdin
  puts HELP
  print '> '
end

ToyRobotSimulator.run(input, log_level: options[:log_level])
